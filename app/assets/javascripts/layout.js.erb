$(document).on('ready page:load', function() {
	// show settings dropdown	
	$(".header-nav-list-dropdown, .find-friends, .notifications").on('click', function(e) { 
		e.stopPropagation();
		dd = $(this).find("ul");
	  dd.css('display') == 'none' ? dd.show() : dd.hide();
	});  
	// hide settings/notifications/find friends dd menus
	$(window).on('click', function() { $(".dd-li").hide(); });

	// Send ajax request when user clicks notifications tab
	$(".notifications").on('click', function() {
		$(".notifications-dropdown-li-item").each(function() {
				if ($(this).data("seen") == false) {
					id = $(this).data("notification_id");

					$.ajax({type: "POST", url: "/seen", data: {id: id},
						success: function(response) {
							$(".notification-count").html("");
						}
					});
				}
		});	
	});
	
	// Change time zone according to location. See https://bitbucket.org/pellepim/jstimezonedetect
	var timezone = jstz.determine();
	document.cookie = 'time_zone='+timezone.name()+';';


	function navResponsive(nav_width_px, nav_width_em) {

		// Make header navigation responsive
		$(".drawer-nav-icon").on('click', function(event) {
			if ($('.header-nav').css("left") == nav_width_px) {
				$('.header-nav').css("left", "0px");
				$("#application_wrapper").css("margin", "0 auto 0 -360px");
			} else {
				$("#application_wrapper").css("margin", "0 auto");
				$('.header-nav').css("left", nav_width_em);
			}
		});
	
		$(window).on('resize', function() {
			if ($(window).width() > 640) {
				$(".header-nav").css("left", "");
				$("#application_wrapper").css("margin", "0 auto");
			}
		});
	}

	navResponsive("130px", "10em");


});

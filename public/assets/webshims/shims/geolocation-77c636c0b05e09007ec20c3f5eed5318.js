!function(e){if(!navigator.geolocation){var o=function(){setTimeout(function(){throw"document.write is overwritten by geolocation shim. This method is incompatible with this plugin"},1)},t=0,i=webshims.cfg.geolocation||{};navigator.geolocation=function(){var n,a={getCurrentPosition:function(t,a,c){var r,s,u,l=2,d=function(){if(!u)if(n){if(u=!0,t(e.extend({timestamp:(new Date).getTime()},n)),m(),window.JSON&&window.sessionStorage)try{sessionStorage.setItem("storedGeolocationData654321",JSON.stringify(n))}catch(o){}}else a&&!l&&(u=!0,m(),a({code:2,message:"POSITION_UNAVAILABLE"}))},g=function(){l--,w(),d()},m=function(){e(document).unbind("google-loader",m),clearTimeout(s),clearTimeout(r)},w=function(){if(n||!window.google||!google.loader||!google.loader.ClientLocation)return!1;var o=google.loader.ClientLocation;return n={coords:{latitude:o.latitude,longitude:o.longitude,altitude:null,accuracy:43e3,altitudeAccuracy:null,heading:parseInt("NaN",10),velocity:null},address:e.extend({streetNumber:"",street:"",premises:"",county:"",postalCode:""},o.address)},!0},f=function(){if(!n&&(w(),!n&&window.JSON&&window.sessionStorage))try{n=sessionStorage.getItem("storedGeolocationData654321"),n=n?JSON.parse(n):!1,n.coords||(n=!1)}catch(e){n=!1}};return f(),n?(setTimeout(d,1),void 0):i.confirmText&&!confirm(i.confirmText.replace("{location}",location.hostname))?(a&&a({code:1,message:"PERMISSION_DENIED"}),void 0):(e.ajax({url:"http://freegeoip.net/json/",dataType:"jsonp",cache:!0,jsonp:"callback",success:function(e){l--,e&&(n=n||{coords:{latitude:e.latitude,longitude:e.longitude,altitude:null,accuracy:43e3,altitudeAccuracy:null,heading:parseInt("NaN",10),velocity:null},address:{city:e.city,country:e.country_name,countryCode:e.country_code,county:"",postalCode:e.zipcode,premises:"",region:e.region_name,street:"",streetNumber:""}},d())},error:function(){l--,d()}}),clearTimeout(s),window.google&&window.google.loader?l--:s=setTimeout(function(){i.destroyWrite&&(document.write=o,document.writeln=o),e(document).one("google-loader",g),webshims.loader.loadScript("http://www.google.com/jsapi",!1,"google-loader")},800),r=c&&c.timeout?setTimeout(function(){m(),a&&a({code:3,message:"TIMEOUT"})},c.timeout):setTimeout(function(){l=0,d()},1e4),void 0)},clearWatch:e.noop};return a.watchPosition=function(e,o,i){return a.getCurrentPosition(e,o,i),t++,t},a}(),webshims.isReady("geolocation",!0)}}(webshims.$);